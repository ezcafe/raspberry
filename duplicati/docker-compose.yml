version: "2.1"
services:
  duplicati:
    image: linuxserver/duplicati
    container_name: duplicati
    environment:
      - PUID=1000 # this should match the ouput of `id -u admin` on the CLI
      - PGID=1000 # this should match the ouput of `id -g admin` on the CLI
      - TZ=${TZ} # Set the appropriate timezone
      # cd raspberry => pwd => raspberry-location
      - CLI_ARGS=--run-script-before=./before.sh --run-script-after=./after.sh
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /usr/bin/docker:/usr/bin/docker
      - duplicati_data:/config #Duplicati Config Files, for consisency across re-deployments
      - /var/lib/docker/volumes:/docker_volumes:rw # docker volume ls => docker inspect volume name => volume location
      - <raspberry-location>:/docker_source:rw # cd raspberry => pwd => raspberry-location
    ports:
      - ${DUPLICATI_PORT}:8200
    restart: unless-stopped

volumes:
  duplicati_data: 