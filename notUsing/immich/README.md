# Immich

## Create backup folder

mkdir ${HOME}/backups/
mkdir ${HOME}/backups/immich/
mkdir ${HOME}/backups/immich/data
mkdir ${HOME}/backups/immich/upload

## Authentik

### Create Provider

- Select `OAuth2/OpenID Provider`
- Name: `Immich`
- Authentication flow: default-authentication-flow (Welcome to authentik!)
- Authorization flow: default-provider-authorization-explicit-consent (Authorize Application)
- Client type: Confidential
- Client ID: <auto-generated>
- Client Secret: <auto-generated>
- Redirect URIs/Origins (RegEx): https://<your-immich-domain>/oauth2/oidc/callback
- Signing Key: `authentik Self-signed Certificate`

### Create Application

- Name: `Immich`
- Slug: `immich`
- Group: `selfhosted`
- Provider: <select-created-immich-provider>
- Policy engine mode: any

### Config Immich

- Go to Settings -> OAuth Authentication
- ISSUER URL: https://<your-auth-domain>/application/o/immich/
- Client ID: Enter your Client ID from authentik
- Client Secret: Enter your Client Secret from authentik
- Scope: `openid email profile`
- Button text: `Sign in with OpenID Connect`